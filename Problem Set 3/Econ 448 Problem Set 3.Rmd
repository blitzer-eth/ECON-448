---
title: "Econ 448"
author: "Alex Lin"
date: "`r format(Sys.time(), '%m/%d/%Y')`"
output:
  html_document:
    df_print: paged
subtitle: Problem Set 3
---
## Concept Questions

1.	(14 points) Consider Weiss’ model of household production in a marriage between two people a and b with wages $w_a$ and $w_b$ (p. 84), but with constant returns to scale in production.  Total household production is $Z=\sqrt{(x_a+x_b)(t_a+t_b)}$ and both partners face the budget constraint $x_i=w_ih_i$ and time constraint $t_i+h_i=1$ for i=a,b.  Solve for Z in the following situations:

Household production:

$$
Z = \sqrt{(x_a + x_b)(t_a + t_b)},\qquad
x_i = w_i h_i,\quad t_i + h_i = 1.
$$

1.1 (6 points) Household members have different comparative advantages in market work($w_a>w_b$) and the person with the higher market earnings devotes all of her time to market work while the person with lower market earnings devotes all of his time to home production.

Person (a): ($h_a$ = 1,\ $t_a$ = 0)
Person (b): ($h_b$ = 0,\ $t_b$ = 1)

Then

$$
x_a = w_a,\quad x_b = 0
\Rightarrow x_a + x_b = w_a,\quad t_a + t_b = 1.
$$

So

$$
Z = \sqrt{w_a \cdot 1} = \sqrt{w_a}.
$$

Answer 1.1:
$$Z = \sqrt{w_a}.$$

1.2 (6 points) All household members have the same comparative advantage in market work ($w_a=w_b$) and both partners spend ½ of their time in market work and ½ of their time in home production.

($h_a = h_b = \tfrac{1}{2}$,$\ t_a = t_b = \tfrac{1}{2}$).

Then

$$
x_a = \tfrac{w}{2},\quad x_b = \tfrac{w}{2}
\Rightarrow x_a + x_b = w,\quad t_a + t_b = 1.
$$

So

$$
Z = \sqrt{w \cdot 1} = \sqrt{w}.
$$

Answer 1.2:
$$Z = \sqrt{w}.$$

1.3 (4 points) How do the gains from marriage differ in problem 1 from the increasing returns to scale situation examined in class?  Be specific about both cases.

Under Constant Returns:

* With equal wages, both specialization and the 50-50 division of time share the same result, and that result is $Z = \sqrt{w}$, so the formula for $Z$ is

* With varying wages, the gains of specialization are ($Z = \sqrt{w_a}$), but these gains are generated only through time allocation and not through the technology itself. With the presence of increasing returns (in class), the degree of marriage specialization, denoted by $Z$, exceeded any other interior solution and thus the gains of marriage were greater and also varied depending on both the pooling and the production technique used.

2. (15 points) One version of a family’s common preferences utility function can be 
$U(c_m,c_f )=c_m^\alpha*c_f^{(1-\alpha)}$
Where $c_m$ and $c_f$ are the consumption of the family’s product (Z) for person m and person f, respectively.  

Utility:

$$
U(c_m,c_f) = c_m^\alpha c_f^{1-\alpha},\qquad
c_m + c_f = Z_{mf}.
$$

2.1 (7 points) If the family wants to choose cm and cf to maximize their utility subject to budget constraint $Z_mf=c_m+c_f$, solve for their optimal choice of consumption.

FOC ratio:

$$
\frac{c_m}{c_f} = \frac{\alpha}{1-\alpha}.
$$

Using ($c_m + c_f = Z_{mf}$):

$$
c_f = (1-\alpha) Z_{mf},\qquad
c_m = \alpha Z_{mf}.
$$

Answer 2.1:
$$
c_m^* = \alpha Z_{mf},\qquad
c_f^* = (1-\alpha) Z_{mf}.
$$
  
2.2 (4 points) Using the results from Weiss’s model (solved in lecture and the reading) that an individual i’s consumption of Z outside of marriage is $\frac{1}{4} w_i$, and the couple’s total married consumption is $max(w_m,w_f)$, find the gains from marriage for both parties if $w_m=w_f=w$ (your answer will be in terms of w and $\alpha$). 

Outside marriage:

$$
c_m^{S} = \tfrac{1}{4}w,\quad c_f^{S} = \tfrac{1}{4}w.
$$

Married total:

$$
Z_{mf} = \max(w_m,w_f) = w,
$$

so from 2.1:

$$
c_m^{M} = \alpha w,\quad c_f^{M} = (1-\alpha)w.
$$

Gains:

$$
\Delta c_m = c_m^{M} - c_m^{S}
= \alpha w - \tfrac{1}{4}w
= w\Bigl(\alpha - \tfrac{1}{4}\Bigr),
$$

$$
\Delta c_f = c_f^{M} - c_f^{S}
= (1-\alpha)w - \tfrac{1}{4}w
= w\Bigl(\tfrac{3}{4} - \alpha\Bigr).
$$

Answer 2.2:
$$
\Delta c_m = w\Bigl(\alpha - \tfrac{1}{4}\Bigr),\qquad
\Delta c_f = w\Bigl(\tfrac{3}{4} - \alpha\Bigr).
$$
	
2.3 (4 points) Using the results from Weiss’s model (solved in lecture and the reading) that an individual i’s consumption of Z outside of marriage is $\frac{1}{4} w_i$, and the couple’s total married consumption is $max(w_m,w_f)$, find the gains from marriage for both parties if $w_m>w_f$ (your answer will be in terms of $w_m, w_f$ and $\alpha$).

Outside marriage:

$$
c_m^{S} = \tfrac{1}{4}w_m,\quad c_f^{S} = \tfrac{1}{4}w_f.
$$

Married total:

$$
Z_{mf} = \max(w_m,w_f) = w_m,
$$

so

$$
c_m^{M} = \alpha w_m,\quad c_f^{M} = (1-\alpha)w_m.
$$

Gains:

$$
\Delta c_m = \alpha w_m - \tfrac{1}{4}w_m
= w_m\Bigl(\alpha - \tfrac{1}{4}\Bigr),
$$

$$
\Delta c_f = (1-\alpha)w_m - \tfrac{1}{4}w_f.
$$

**Answer 2.3:**
$$
\Delta c_m = w_m\Bigl(\alpha - \tfrac{1}{4}\Bigr),\qquad
\Delta c_f = (1-\alpha)w_m - \tfrac{1}{4}w_f.
$$

3. (16 points)In a simplified bargaining model of marriage, the couple jointly maximizes the following utility function:
$U=[c_m - T_m]*[c_f- T_f]$

Subject to $Z= c_m+c_f$, where Z is total family income

And $c_m ≥ T_m$ and $c_f ≥ T_f$

Person f is the female partner and m is the male partner

Utility:

$$
U = (c_m - T_m)(c_f - T_f),\qquad
c_m + c_f = Z.
$$


3.1 (5 points) What is $c_f-T_f$?  Give two examples from class notes or readings of events that would increase the value of $T_f$ and explain why $T_f$ increases in these cases.  Be as specific as possible about your examples.

* (c_f - T_f) is the female partner’s surplus from marriage over her threat point.

Two events that increase (T_f):

1. Higher wages for females or better job opportunities, thus increasing their earnings. 
2. Greater divorce and property rights for women, which raise the reward to the woman if the marriage fails.

3.2 (7 points) As shown in lecture, the utility maximizing condition on $C_m$ and $C_f$ is $C_m - T_m = C_f- T_f$. Solve for $C_f$ and $C_m$ in terms of Z,$T_m$, and $T_f$.

Condition:

$$
c_m - T_m = c_f - T_f.
$$

So

$$
c_m = c_f - T_f + T_m.
$$

Use (c_m + c_f = Z):

$$
(c_f - T_f + T_m) + c_f = Z
\Rightarrow 2c_f + (T_m - T_f) = Z.
$$

Then

$$
c_f = \frac{Z - T_m + T_f}{2},\qquad
c_m = \frac{Z + T_m - T_f}{2}.
$$

Answer 3.2:
$$
c_f = \frac{Z - T_m + T_f}{2},\qquad
c_m = \frac{Z + T_m - T_f}{2}.
$$

3.3 (4 points) Imagine you had a survey with variables for $c_f$ and $T_f$. What does your answer to 3.2 predict about the relationship between these two variables? Write out a linear regression model that you could use to estimate this relationship and test your prediction.

From 3.2:

$$
c_f = \frac{Z - T_m}{2} + \frac{1}{2}T_f.
$$

So, holding ($Z$) and ($T_m$) fixed, the model predicts a positive linear relationship between ($c_f$) and ($T_f$) with slope (1/2).

A simple regression to test this:

$$
c_{f,i} = \beta_0 + \beta_1 T_{f,i} + \varepsilon_i,
$$

with the prediction ($\beta_1 > 0$) (in the ideal case ($\beta_1 \approx 0.5$)).

---------------------------------------------------------------------------------------------------

## Data Analysis Questions

4. These questions refer to the data set "0.1% sample Mexican women age 18+" available via the Econ 448 class account from ipums.org.  Please download the data and answer the following questions.

```{r setup, message=FALSE, warning=FALSE}
setwd("C:/Users/alexl/OneDrive/Desktop/桌面/UW/CourseWork/Senior Year/Autumn 2025/ECON 448/Problem Set 3")

df_raw <- read.csv(gzfile("ipumsi_00003.csv.gz"))

names(df_raw)

library(dplyr)
library(stargazer)
library(ggplot2)
library(broom)
library(knitr)
```

4.1 Create a formatted table of summary statistics (mean, std dev, max, min) for all variables that you use in your analysis (Hint: wait until you answer all of the other questions before finalizing this part so you know what variables you will use).

```{r}
df_4 <- df_raw %>%
  filter(AGE >= 18, AGE <= 65)

analysis_vars <- df_4 %>%
  select(AGE, MARST, EMPSTAT, INCEARN, GEO1_MX)

stargazer(
  analysis_vars,
  type = "text",
  summary.stat = c("mean", "sd", "min", "max"),
  title = "Summary statistics for analysis variables"
)
```


4.2 Filter your observations so that you only have women in your sample who are single, married, and  divorced. Then create a new variable `ever_married' that indicates whether the woman has ever been married. Plot the proportion of women ever married by age, from age 18 to 65. 

```{r}
df_4_2 <- df_raw %>%
  filter(
    AGE >= 18, AGE <= 65,
    MARST %in% c(1, 2, 4) # 1 = single, 2 = married, 4 = divorced
  ) %>%
  mutate(
    ever_married = as.integer(MARST %in% c(2, 4))
  )

prop_ever_married_age <- df_4_2 %>%
  group_by(AGE) %>%
  summarise(
    prop_ever_married = mean(ever_married, na.rm = TRUE),
    .groups = "drop"
  )

ggplot(prop_ever_married_age, aes(x = AGE, y = prop_ever_married)) +
  geom_line() +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  labs(
    x = "Age",
    y = "Proportion ever married",
    title = "Proportion of women ever married by age (18–65)"
  ) +
  theme_minimal()
```

4.3 Now estimate the association between a woman's marital status and her status in the labor market, with women's employment as a binary outcome. Show the results of your regression and write a few sentences explaining your results.

It seems pretty clear that married women would be less likely to work than unmarried women, but what impact does access to divorce have on the choices made by married women? Economists debate this question. The advent of unilateral (i.e. "no fault") divorce is probably bad for women's bargaining power, and if that is the case, we might predict that married women are more likely to go to work in order to gain back some bargaining power once divorce gets easier. Alternatively, if men prefer for their wives not to work, we may see women withdraw from the labor force when divorce gets easier and men's bargaining power increases.

```{r}
df_4_3 <- df_raw %>%
  filter(
    AGE >= 18, AGE <= 65,
    MARST %in% c(1, 2, 4) # 1 = single, 2 = married, 4 = divorced
  ) %>%
  mutate(
    employed = as.integer(EMPSTAT == 1),
    married  = as.integer(MARST == 2),
    divorced = as.integer(MARST == 4)
  )

model_4_3 <- lm(employed ~ married + divorced, data = df_4_3)

summary(model_4_3)
```
The intercept of 0.443 represents the predicted employment probability for single women, so that roughly 44.3% of single women are employed. The coefficient for married is -0.201, indicating that married women are 20.1 percentage points less likely to be employed than single women, and a very precise estimate is obtained. The coefficient for divorced is of a magnitude of -0.087, implying that divorced women are 8.7 percentage points less likely to be employed than single women but are still more likely to be employed than married women.

Taken together, these findings are consistent with the hypothesis that marriage is related to lower participation for women, but that divorce brings the outcomes of the married into closer alignment with the outcomes of the never-married. This is consistent with a bargaining model where the absence of a marriage, or being at least not currently married, is related to enhanced outside options and the probability of participation.


4.4 For this exercise, estimate the relationship between living in a Mexican state with unilateral divorce on married women's employment and earnings (Hint: filter your data to only look at currently married women). Display your regression results in a table and write a few sentences explaining what, if anything, they imply about the role of unilateral divorce in women's bargaining power. 

```{r}
# Treat Mexico City as the unilateral divorce state
unilat_states <- c(484001)

df_4_4 <- df_raw %>%
  filter(
    AGE >= 18, AGE <= 65,
    MARST == 2   # currently married women
  ) %>%
  mutate(
    unilat_divorce = as.integer(GEO1_MX %in% unilat_states),
    employed       = as.integer(EMPSTAT == 1),
    INCEARN_clean  = ifelse(INCEARN >= 99999998, NA, INCEARN), # I noticed that the maximum of INCEARN in my 4.1 summary statistics is 99,999,999. I searched online and learned that very large values like this are special codes for missing or top coded income
    ln_earnings    = log(INCEARN_clean + 1)
  )

model_emp  <- lm(employed    ~ unilat_divorce, data = df_4_4)

model_earn <- lm(ln_earnings ~ unilat_divorce, data = df_4_4)

tab_emp  <- tidy(model_emp)  %>% mutate(model = "Employment")
tab_earn <- tidy(model_earn) %>% mutate(model = "Log earnings")

results_4_4 <- bind_rows(tab_emp, tab_earn) %>%
  select(model, term, estimate, std.error, statistic, p.value)

kable(results_4_4, digits = 3,
      caption = "Effect of unilateral divorce (Mexico City) on married women's employment and earnings")
```
Married women in Mexico City (unilateral divorce state) are roughly 15 percent more likely to be working than married women in any other state, and the difference is statistically significant. This suggests that the ability to obtain a divorce could improve a woman’s outside options and lead her to enter the labor force, and that it also could improve her earnings, although the latter estimate is imprecise and does not indicate a clear wage premium for the woman if she is working.

